<div class="dashboard-container">
    <div class="max-w-7xl mx-auto space-y-8">

        <!-- Header -->
        <div class="header-section">
            <div class="header-content">
                <h1 class="main-title">Health Analytics</h1>
                <p class="subtitle">Advanced insights from your Apple Health
                    data</p>
            </div>

            <!-- Controls -->
            <div class="controls-section">
                <div class="date-selector">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2">
                        </rect>
                        <line x1="16" y1="2" x2="16" y2="6">

                        </line>
                        <line x1="8" y1="2" x2="8" y2="6">

                        </line>
                        <line x1="3" y1="10" x2="21" y2="10">

                        </line>
                    </svg>
                    <select [(ngModel)]="dateRange" (change)="onDateRangeChange()" class="select-input">
                        <option value="7d">Last 7 days</option>
                        <option value="14d">Last 14 days</option>
                        <option value="30d">Last 30 days</option>
                        <option value="week">This week</option>
                        <option value="month">This month</option>
                        <option value="year">This year</option>
                        <option value="all">All time</option>
                        <option value="custom">Custom range…</option>
                    </select>
                    <div class="custom-range" *ngIf="dateRange === 'custom'">
                        <input type="date" [(ngModel)]="customFrom" class="date-input" aria-label="From date" />
                        <input type="date" [(ngModel)]="customTo" class="date-input" aria-label="To date" />
                        <button class="view-btn" (click)="applyCustomRange()" [disabled]="!customFrom || !customTo || customFrom > customTo">Apply</button>
                    </div>
                </div>

                <div class="view-toggle">
                    <button *ngFor="let view of views" [class]="getViewButtonClass(view)" (click)="setSelectedView(view)">
                        {{ view | titlecase }}
                    </button>
                </div>

                <div class="logout-section">
                    <button class="logout-btn" (click)="logout()">Logout</button>
                </div>
            </div>
        </div>

        <!-- Daily Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card steps-card" (mouseenter)="onCardHover('steps')" (mouseleave)="onCardLeave('steps')">
                <div class="card-header">
                    <div class="icon-section">
                        <div class="icon-container steps-icon">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <polyline points="22,12 18,12 15,21 9,3 6,12 2,12">
                                </polyline>
                            </svg>
                        </div>
                        <h3 class="card-title">Steps</h3>
                    </div>
                    <div class="trend-badge steps-trend">
                        {{ getTrendIndicator('steps') }}{{
                        getTrendPercentage('steps') }}%
                    </div>
                </div>

                <div class="card-content">
                    <div class="main-value">
                        <span class="value-number">{{ stepsStats.current |
                            number }}</span>
                    </div>

                    <div class="stats-details">
                        <div class="stat-row">
                            <span class="stat-label">Avg:</span>
                            <span class="stat-value">{{ stepsStats.average |
                                number:'1.0-0' }}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Max:</span>
                            <span class="stat-value">{{ stepsStats.max |
                                number:'1.0-0' }}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Med:</span>
                            <span class="stat-value">{{ stepsStats.median |
                                number:'1.0-0' }}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Min:</span>
                            <span class="stat-value">{{ stepsStats.min |
                                number:'1.0-0' }}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Total:</span>
                            <span class="stat-value">{{ stepsStats.total |
                                number:'1.0-0' }}</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="stat-card calories-card">
                <div class="card-header">
                    <div class="icon-section">
                        <div class="icon-container calories-icon">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2">
                                </polygon>
                            </svg>
                        </div>
                        <h3 class="card-title">Calories</h3>
                    </div>
                    <div class="trend-badge calories-trend">
                        {{ getTrendIndicator('calories') }}{{
                        getTrendPercentage('calories') }}%
                    </div>
                </div>

                <div class="card-content">
                    <div class="main-value">
                        <span class="value-number">{{ caloriesStats.current |
                            number:'1.0-0' }}</span>
                        <span class="unit">{{' kcal'}}</span>
                    </div>

                    <div class="stats-details">
                        <div class="stat-row">
                            <span class="stat-label">Avg:</span>
                            <span class="stat-value">{{ caloriesStats.average |
                                number:'1.0-0' }}{{' kcal'}}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Max:</span>
                            <span class="stat-value">{{ caloriesStats.max |
                                number:'1.0-0' }}{{' kcal'}}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Med:</span>
                            <span class="stat-value">{{ caloriesStats.median |
                                number:'1.0-0' }}{{' kcal'}}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Min:</span>
                            <span class="stat-value">{{ caloriesStats.min |
                                number:'1.0-0' }}{{' kcal'}}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Total:</span>
                            <span class="stat-value">{{ caloriesStats.total |
                                number:'1.0-0' }}{{' kcal'}}</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="stat-card distance-card">
                <div class="card-header">
                    <div class="icon-section">
                        <div class="icon-container distance-icon">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <circle cx="12" cy="10" r="3">

                                </circle>
                                <path d="m12 21.7-.4-.8a13.5 13.5 0 0 1-2.9-8.9c0-7.4 6-13.4 13.4-13.4S35.5 4.6 35.5 12c0 3.4-1.3 6.6-2.9 8.9l-.4.8Z">
                                </path>
                            </svg>
                        </div>
                        <h3 class="card-title">Distance</h3>
                    </div>
                    <div class="trend-badge distance-trend">
                        {{ getTrendIndicator('distance') }}{{
                        getTrendPercentage('distance') }}%
                    </div>
                </div>

                <div class="card-content">
                    <div class="main-value">
                        <span class="value-number">{{ distanceStats.current |
                            number:'1.1-1' }}</span>
                        <span class="unit">{{' km'}}</span>
                    </div>

                    <div class="stats-details">
                        <div class="stat-row">
                            <span class="stat-label">Avg:</span>
                            <span class="stat-value">{{ distanceStats.average
                                }}{{' km'}}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Max:</span>
                            <span class="stat-value">{{ distanceStats.max
                                }}{{' km'}}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Med:</span>
                            <span class="stat-value">{{ distanceStats.median
                                }}{{' km'}}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Min:</span>
                            <span class="stat-value">{{ distanceStats.min
                                }}{{' km'}}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Total:</span>
                            <span class="stat-value">{{ distanceStats.total
                                }}{{' km'}}</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="stat-card weight-card">
                <div class="card-header">
                    <div class="icon-section">
                        <div class="icon-container weight-icon">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <polyline points="22,12 18,12 15,21 9,3 6,12 2,12">
                                </polyline>
                            </svg>
                        </div>
                        <h3 class="card-title">Weight</h3>
                    </div>
                    <div class="trend-badge weight-trend">
                        -{{ getWeightLossPct() }}%
                    </div>
                </div>

                <div class="card-content">
                    <div class="main-value">
                        <span class="value-number">{{ weightStats.current |
                            number:'1.1-1' }}</span>
                        <span class="unit">{{' kg'}}</span>
                    </div>

                    <div class="stats-details">
                        <div class="stat-row">
                            <span class="stat-label">Initial:</span>
                            <span class="stat-value">{{ getInitialWeight() }}{{' kg'}}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Loss:</span>
                            <span class="stat-value">{{ getWeightLossKg() }}{{' kg' }} </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="charts-grid">
            <!-- Steps Chart -->
            <div class="chart-container">
                <div class="chart-header">
                    <h3 class="chart-title">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <polyline points="22,12 18,12 15,21 9,3 6,12 2,12">

                            </polyline>
                        </svg>
                        {{ getChartTitle('steps') }}
                    </h3>
                    <div class="chart-info">
                        <ng-container [ngSwitch]="selectedView">
                            <span *ngSwitchCase="'weekly'">Total: {{ stepsStats.total | number:'1.0-0' }}</span>
                            <span *ngSwitchCase="'trends'">Avg: {{ stepsStats.average | number:'1.0-0' }}</span>
                            <span *ngSwitchDefault>Total: {{ stepsStats.total | number:'1.0-0' }}</span>
                        </ng-container>
                    </div>
                </div>
                <div class="simple-chart">
                    <!-- Chart type toggle for Steps -->
                    <div class="view-toggle chart-type-toggle">
                        <button class="view-btn" [class.active]="stepsChartType === 'column'" (click)="setStepsChartType('column')">Column</button>
                        <button class="view-btn" [class.active]="stepsChartType === 'line'" (click)="setStepsChartType('line')">Line</button>
                        <button class="view-btn" [class.active]="stepsChartType === 'area'" (click)="setStepsChartType('area')">Area</button>
                    </div>

                    <ng-container [ngSwitch]="stepsChartType">
                        <!-- Column chart -->
                        <div *ngSwitchCase="'column'" class="chart-bars" (mouseleave)="hideBarTooltip('steps')">
                            <div *ngFor="let pt of getStepsChartData(); let i = index; trackBy: trackByIdx" class="chart-bar steps-bar" [style.height.%]="(pt.value / getMaxChartValue('steps')) * 100" [style.animation-delay.ms]="i * 100" (mouseenter)="showBarTooltip('steps', i, $event)">
                            </div>
                            <div *ngIf="tooltip.steps.visible" class="chart-tooltip" [style.left.px]="tooltip.steps.left" [style.top.px]="tooltip.steps.top">
                                <div class="tooltip-value">{{ tooltip.steps.value | number:'1.0-0' }}</div>
                                <div class="tooltip-label">{{ tooltip.steps.label }}</div>
                            </div>
                        </div>

                        <!-- Line chart -->
                        <div *ngSwitchCase="'line'" class="chart-line">
                            <svg class="chart-svg" viewBox="0 0 100 100" preserveAspectRatio="none" (mousemove)="onSvgMove('steps', $event)" (mouseleave)="onSvgLeave('steps')">
                                <polyline class="line-polyline" [attr.points]="getSvgLinePoints('steps')" />
                            </svg>
                            <div *ngIf="tooltip.steps.visible" class="chart-tooltip" [style.left.px]="tooltip.steps.left" [style.top.px]="tooltip.steps.top">
                                <div class="tooltip-value">{{ tooltip.steps.value | number:'1.0-0' }}</div>
                                <div class="tooltip-label">{{ tooltip.steps.label }}</div>
                            </div>
                        </div>

                        <!-- Area chart -->
                        <div *ngSwitchCase="'area'" class="chart-area">
                            <svg class="chart-svg" viewBox="0 0 100 100" preserveAspectRatio="none" (mousemove)="onSvgMove('steps', $event)" (mouseleave)="onSvgLeave('steps')">
                                <polygon class="area-polygon steps-area" [attr.points]="getSvgAreaPoints('steps')" />
                            </svg>
                            <div *ngIf="tooltip.steps.visible" class="chart-tooltip" [style.left.px]="tooltip.steps.left" [style.top.px]="tooltip.steps.top">
                                <div class="tooltip-value">{{ tooltip.steps.value | number:'1.0-0' }}</div>
                                <div class="tooltip-label">{{ tooltip.steps.label }}</div>
                            </div>
                        </div>

                        <!-- Fallback -->
                        <div *ngSwitchDefault class="chart-bars">
                            <div *ngFor="let pt of getStepsChartData(); let i = index" class="chart-bar steps-bar" [style.height.%]="(pt.value / getMaxChartValue('steps')) * 100" [style.animation-delay.ms]="i * 100">
                            </div>
                        </div>
                    </ng-container>
                    <div class="chart-labels">
                        <span *ngFor="let pt of getLabelPoints('steps'); trackBy: trackByIdx" class="chart-label">
                            {{ pt.label }}
                        </span>
                    </div>
                </div>
            </div>

            <!-- Calories Chart -->
            <div class="chart-container">
                <div class="chart-header">
                    <h3 class="chart-title">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2">

                            </polygon>
                        </svg>
                        {{ getChartTitle('calories') }}
                    </h3>
                    <div class="chart-info">
                        <ng-container [ngSwitch]="selectedView">
                            <span *ngSwitchCase="'weekly'">Total: {{ caloriesStats.total | number:'1.0-0' }} {{' kcal'}}</span>
                            <span *ngSwitchCase="'trends'">Avg: {{ caloriesStats.average | number:'1.0-0' }} {{' kcal'}}/day</span>
                            <span *ngSwitchDefault>Avg: {{ caloriesStats.average | number:'1.0-0' }} {{' kcal'}}/day</span>
                        </ng-container>
                    </div>
                </div>
                <div class="simple-chart">
                    <!-- Chart type toggle for Calories -->
                    <div class="view-toggle chart-type-toggle">
                        <button class="view-btn" [class.active]="caloriesChartType === 'column'" (click)="setCaloriesChartType('column')">Column</button>
                        <button class="view-btn" [class.active]="caloriesChartType === 'line'" (click)="setCaloriesChartType('line')">Line</button>
                        <button class="view-btn" [class.active]="caloriesChartType === 'area'" (click)="setCaloriesChartType('area')">Area</button>
                    </div>

                    <ng-container [ngSwitch]="caloriesChartType">
                        <!-- Column chart -->
                        <div *ngSwitchCase="'column'" class="chart-bars" (mouseleave)="hideBarTooltip('calories')">
                            <div *ngFor="let pt of getCaloriesChartData(); let i = index; trackBy: trackByIdx" class="chart-bar calories-bar" [style.height.%]="(pt.value / getMaxChartValue('calories')) * 100" [style.animation-delay.ms]="i * 100" (mouseenter)="showBarTooltip('calories', i, $event)">
                            </div>
                            <div *ngIf="tooltip.calories.visible" class="chart-tooltip" [style.left.px]="tooltip.calories.left" [style.top.px]="tooltip.calories.top">
                                <div class="tooltip-value">{{ tooltip.calories.value | number:'1.0-0' }}</div>
                                <div class="tooltip-label">{{ tooltip.calories.label }}</div>
                            </div>
                        </div>

                        <!-- Line chart -->
                        <div *ngSwitchCase="'line'" class="chart-line">
                            <svg class="chart-svg" viewBox="0 0 100 100" preserveAspectRatio="none" (mousemove)="onSvgMove('calories', $event)" (mouseleave)="onSvgLeave('calories')">
                                <polyline class="line-polyline calories-line" [attr.points]="getSvgLinePoints('calories')" />
                            </svg>
                            <div *ngIf="tooltip.calories.visible" class="chart-tooltip" [style.left.px]="tooltip.calories.left" [style.top.px]="tooltip.calories.top">
                                <div class="tooltip-value">{{ tooltip.calories.value | number:'1.0-0' }}</div>
                                <div class="tooltip-label">{{ tooltip.calories.label }}</div>
                            </div>
                        </div>

                        <!-- Area chart -->
                        <div *ngSwitchCase="'area'" class="chart-area">
                            <svg class="chart-svg" viewBox="0 0 100 100" preserveAspectRatio="none" (mousemove)="onSvgMove('calories', $event)" (mouseleave)="onSvgLeave('calories')">
                                <polygon class="area-polygon calories-area" [attr.points]="getSvgAreaPoints('calories')" />
                            </svg>
                            <div *ngIf="tooltip.calories.visible" class="chart-tooltip" [style.left.px]="tooltip.calories.left" [style.top.px]="tooltip.calories.top">
                                <div class="tooltip-value">{{ tooltip.calories.value | number:'1.0-0' }}</div>
                                <div class="tooltip-label">{{ tooltip.calories.label }}</div>
                            </div>
                        </div>

                        <!-- Fallback -->
                        <div *ngSwitchDefault class="chart-bars">
                            <div *ngFor="let pt of getCaloriesChartData(); let i = index" class="chart-bar calories-bar" [style.height.%]="(pt.value / getMaxChartValue('calories')) * 100" [style.animation-delay.ms]="i * 100">
                            </div>
                        </div>
                    </ng-container>
                    <div class="chart-labels">
                        <span *ngFor="let pt of getLabelPoints('calories'); trackBy: trackByIdx" class="chart-label">
                            {{ pt.label }}
                        </span>
                    </div>
                </div>
            </div>

            <!-- Merged Full-Width Chart: Active vs Basal | Achieved vs Goal -->
            <div class="chart-container span-2">
                <div class="chart-header">
                    <h3 class="chart-title">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"></polygon>
                        </svg>
                        <ng-container [ngSwitch]="mergedChartView">
                            <span *ngSwitchCase="'activeBasal'">Active vs Basal Calories</span>
                            <span *ngSwitchCase="'metricGoal'">Achieved vs Goal</span>
                        </ng-container>
                    </h3>
                    <div class="view-toggle chart-type-toggle">
                        <button class="view-btn" [class.active]="mergedChartView === 'activeBasal'" (click)="setMergedChartView('activeBasal')">Active/Basal</button>
                        <button class="view-btn" [class.active]="mergedChartView === 'metricGoal'" (click)="setMergedChartView('metricGoal')">Achieved/Goal</button>
                    </div>
                </div>
                <div class="chart-info">
                    <ng-container [ngSwitch]="mergedChartView">
                        <ng-container *ngSwitchCase="'activeBasal'">
                            <ng-container *ngIf="getCaloriesSplitTotals() as split">
                                Active: {{ split.active | number:'1.0-0' }} kcal • Basal: {{ split.basal | number:'1.0-0' }} kcal
                            </ng-container>
                        </ng-container>
                        <ng-container *ngSwitchCase="'metricGoal'">
                            Metric: {{ selectedActivityMetric }} • Unit: {{ getMetricUnit(selectedActivityMetric) }}
                        </ng-container>
                    </ng-container>
                </div>

                <!-- Active vs Basal content -->
                <div class="simple-chart" *ngIf="mergedChartView === 'activeBasal'">
                    <div class="dual-legend">
                        <span class="legend-item active"><span class="dot"></span>Active</span>
                        <span class="legend-item basal"><span class="dot"></span>Basal</span>
                    </div>
                    <div class="chart-line">
                        <svg class="chart-svg" viewBox="0 0 100 100" preserveAspectRatio="none" (mousemove)="onSvgMoveDual($event)" (mouseleave)="onSvgLeaveDual()">
                            <polyline class="line-polyline active-line" [attr.points]="getSvgLinePointsActiveBasal('active')" />
                            <polyline class="line-polyline basal-line" [attr.points]="getSvgLinePointsActiveBasal('basal')" />
                        </svg>
                        <div *ngIf="tooltip.activeBasal.visible" class="chart-tooltip" [style.left.px]="tooltip.activeBasal.left" [style.top.px]="tooltip.activeBasal.top">
                            <div class="tooltip-label">{{ tooltip.activeBasal.label }}</div>
                            <div><span class="swatch active"></span>{{ tooltip.activeBasal.active | number:'1.0-0' }} kcal</div>
                            <div><span class="swatch basal"></span>{{ tooltip.activeBasal.basal | number:'1.0-0' }} kcal</div>
                        </div>
                    </div>
                    <div class="chart-labels">
                        <span *ngFor="let pt of getActiveBasalLabelPoints(); trackBy: trackByIdx" class="chart-label">{{ pt.label }}</span>
                    </div>
                </div>

                <!-- Achieved vs Goal content -->
                <div class="simple-chart" *ngIf="mergedChartView === 'metricGoal'">
                    <div class="view-toggle chart-type-toggle" style="margin-bottom: 0.5rem;">
                        <button class="view-btn" [class.active]="selectedActivityMetric === 'activeEnergyBurned'" (click)="setSelectedActivityMetric('activeEnergyBurned')">Energy</button>
                        <button class="view-btn" [class.active]="selectedActivityMetric === 'appleMoveTime'" (click)="setSelectedActivityMetric('appleMoveTime')">Move</button>
                        <button class="view-btn" [class.active]="selectedActivityMetric === 'appleExerciseTime'" (click)="setSelectedActivityMetric('appleExerciseTime')">Exercise</button>
                        <button class="view-btn" [class.active]="selectedActivityMetric === 'appleStandHours'" (click)="setSelectedActivityMetric('appleStandHours')">Stand</button>
                    </div>
                    <div class="metric-legend">
                        <span class="legend-item achieved"><span class="dot"></span>Achieved</span>
                        <span class="legend-item goal"><span class="dot"></span>Goal</span>
                    </div>
                    <div class="chart-line">
                        <svg class="chart-svg" viewBox="0 0 100 100" preserveAspectRatio="none" (mousemove)="onSvgMoveMetricGoal($event)" (mouseleave)="onSvgLeaveMetricGoal()">
                            <polyline class="line-polyline achieved-line" [attr.points]="getSvgLinePointsMetricGoal('achieved')" />
                            <polyline class="line-polyline goal-line" [attr.points]="getSvgLinePointsMetricGoal('goal')" />
                        </svg>
                        <div *ngIf="tooltip.metricGoal.visible" class="chart-tooltip" [style.left.px]="tooltip.metricGoal.left" [style.top.px]="tooltip.metricGoal.top">
                            <div class="tooltip-label">{{ tooltip.metricGoal.label }}</div>
                            <div><span class="swatch achieved"></span>Achieved: {{ tooltip.metricGoal.achieved | number:'1.0-0' }} {{ getMetricUnit(selectedActivityMetric) }}</div>
                            <div><span class="swatch goal"></span>Goal: {{ tooltip.metricGoal.goal | number:'1.0-0' }} {{ getMetricUnit(selectedActivityMetric) }}</div>
                        </div>
                    </div>
                    <div class="chart-labels">
                        <span *ngFor="let pt of getMetricGoalLabelPoints(); trackBy: trackByIdx" class="chart-label">{{ pt.label }}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Advanced Analytics -->
        <div class="analytics-grid">
            <!-- Active Energy Goal -->
            <div class="analytics-card">
                <h3 class="analytics-title">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2">

                        </polygon>
                    </svg>
                    Active Energy Goal
                </h3>
                <ng-container *ngIf="getActiveEnergyGoalTotals() as goal">
                    <div class="calories-split">
                        <div class="calories-donut" [style.--p]="goal.pct + '%'">
                            <div class="donut-center">
                                <div class="donut-value">{{ goal.pct | number:'1.0-0' }}%</div>
                                <div class="donut-sub">of Goal</div>
                            </div>
                        </div>
                        <div class="split-stats">
                            <div class="split-row">
                                <span class="dot active">

                                </span> Burned: {{ goal.burned | number:'1.0-0' }} kcal
                            </div>
                            <div class="split-row">
                                <span class="dot goal">

                                </span> Goal: {{ goal.goal | number:'1.0-0' }} kcal
                            </div>
                        </div>
                    </div>
                </ng-container>
            </div>

            <!-- Weight Tracking -->
            <div class="analytics-card">
                <h3 class="analytics-title">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <polyline points="22,12 18,12 15,21 9,3 6,12 2,12">
                        </polyline>
                    </svg>
                    Weight Tracking
                </h3>
                <div class="weight-chart">
                    <div class="weight-line">
                        <div *ngFor="let data of getRecentData(); let i = index" class="weight-point" [style.left.%]="(i / (getRecentData().length - 1)) * 100" [style.bottom.%]="((data.weight - getMinWeight()) / (getMaxWeight() - getMinWeight())) * 100">
                        </div>
                    </div>
                </div>
                <div class="weight-stats">
                    <div class="weight-stat">
                        <span class="stat-label">Current</span>
                        <span class="stat-value">{{ weightStats.current
                            }}{{' kg '}}</span>
                    </div>
                    {{' \t'}}
                    <div class="weight-stat">
                        <span class="stat-label">Change</span>
                        <span class="stat-value" [class.success]="getWeightLossKg() > 0" [class.error]="getWeightLossKg() < 0">{{ getWeightLossKg() }}{{' kg'}}</span>
                    </div>
                </div>
            </div>

            <!-- Activity Summary -->
            <div class="analytics-card">
                <h3 class="analytics-title">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <line x1="12" y1="20" x2="12" y2="10">

                        </line>
                        <line x1="18" y1="20" x2="18" y2="4">

                        </line>
                        <line x1="6" y1="20" x2="6" y2="16">

                        </line>
                    </svg>
                    Activity Summary
                </h3>
                <div class="activity-bars">
                    <div *ngFor="let activity of activityLevels" class="activity-row">
                        <div class="activity-info">
                            <span class="activity-label">{{ activity.label
                                }}</span>
                            <span class="activity-value">{{ activity.value
                                }}%</span>
                        </div>
                        <div class="activity-bar-container">
                            <div class="activity-bar" [style.width.%]="activity.value" [style.background-color]="activity.color">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer Stats -->
        <div class="footer-stats">
            <div class="footer-stat">
                <div class="footer-value cyan">{{ globalStats.daysTracked }}</div>
                <div class="footer-label">Days Tracked</div>
            </div>
            <div class="footer-stat">
                <div class="footer-value green">{{ getGoalAchievement()
                    }}%</div>
                <div class="footer-label">Goal Achievement</div>
            </div>
            <div class="footer-stat">
                <div class="footer-value orange">{{ getTotalDistance()
                    }}km</div>
                <div class="footer-label">Total Distance</div>
            </div>
            <div class="footer-stat">
                <div class="footer-value purple">{{ globalStats.healthGrade }}</div>
                <div class="footer-label">Health Grade</div>
            </div>
            <div class="footer-stat">
                <div class="footer-value purple">{{ globalStats.healthScore | number:'1.0-0' }}</div>
                <div class="footer-label">Health Score</div>
            </div>
            <div class="footer-stat">
                <div class="footer-value green">{{ globalStats.components.activityScore | number:'1.0-0' }}</div>
                <div class="footer-label">Activity Score</div>
            </div>
            <div class="footer-stat">
                <div class="footer-value cyan">{{ globalStats.components.stepsScore | number:'1.0-0' }}</div>
                <div class="footer-label">Steps Score</div>
            </div>
            <div class="footer-stat">
                <div class="footer-value orange">{{ globalStats.components.streakScore | number:'1.0-0' }}</div>
                <div class="footer-label">Streak Score</div>
            </div>
        </div>
    </div>
</div>